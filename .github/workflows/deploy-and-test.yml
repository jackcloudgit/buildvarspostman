name: Deploy and Conditional Postman Test

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Deploy application
        id: deploy_step
        run: |
          echo "Deploying your application..."
          # Simulate deployment
          echo "Deployment successful!"

  postman-tests:
    needs: deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install yq
        run: sudo apt-get update && sudo apt-get install -y yq

      - name: Read build vars and set env
        id: read_vars
        run: |
          export POSTMAN=$(yq '.postman' .github/build-vars.yml)
          echo "POSTMAN=$POSTMAN" >> $GITHUB_ENV

      - name: Run Postman tests
        if: env.POSTMAN == 'true'
        run: |
          echo "Running Postman tests..."
          # Place your Postman test command here
